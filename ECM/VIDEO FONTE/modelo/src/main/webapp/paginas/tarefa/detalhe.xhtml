<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:pe="http://primefaces.org/ui/extensions">

	<h:form id="form">

		<p:panel id="panel" header="Dados da Solicitação">
			<h:panelGrid columns="2" style="width:37%">

				<p:outputLabel value="Protocolo:" />

				<p:inputText id="protocolo" disabled="true"
					styleClass="ui-priority-primary"
					value="#{tarefaControle.entity.variaveis}/#{tarefaControle.entity.variaveis.ano}" />

			</h:panelGrid>

			
		</p:panel>

		<p:panel header="Documento(s) digitalizado(s)">
			<p:dataTable id="listDoc" var="item" value="#{tarefaControle.itens}"
				emptyMessage="Nenhum registro encontrado."
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

				<p:column style="text-align:left" headerText="Nome">
					<h:outputText value="#{item.name}" />
				</p:column>

				<p:column style="text-align:left" headerText="Tamanho (byte)">
					<h:outputText value="#{item.size}" />
				</p:column>

				<p:column style="text-align:center; width:100px"
					headerText="Download">

					<p:commandButton id="downloadLink" ajax="false"
						onclick="PrimeFaces.monitorDownload(start, stop)" immediate="true"
						icon="ui-icon-arrowthichk-s">
						<p:fileDownload
							value="#{tarefaControle.getFile(item.inputStream)}" />
					</p:commandButton>

				</p:column>
			</p:dataTable>
			<!--  <p style="height: 1%"/> -->
		</p:panel>

		<p:panel id="parecer" header="Parecer">
			<p:inputTextarea maxlength="300" 
				counterTemplate="{0} Caracteres restantes." autoResize="false"
				value="#{tarefaControle.parecer}" required="true"
				requiredMessage="Informe o parecer" style="width:100%;" >
					<p:ajax event="keyup" update="grid" />
			</p:inputTextarea>
		</p:panel>

		<h:panelGrid id="grid" columns="6">
			<p:commandButton id="btnVoltar" value="Voltar" immediate="true"
				update=":form" action="#{tarefaControle.telaPesquisaTarefaPendente}"
				icon="ui-icon-circle-arrow-w" style="margin-right:20px;"
				styleClass="ui-priority-primary" />
	
			<p:commandButton id="btnAprovar" value="Aprovar"
				icon="ui-icon-check" style="margin-right:20px;"
				styleClass="ui-priority-primary" onclick="aprovar.show()" />
	
			<p:commandButton id="btnReprovar" value="Reprovar"
				icon="ui-icon-closethick" style="margin-right:20px;"
				styleClass="ui-priority-primary" onclick="reprovar.show()" />
	
		</h:panelGrid>
		
	</h:form>

	<p:confirmDialog message="Deseja realmente reprovar a tarefa ?" 
		header="CONFIRMAR" severity="alert" appendToBody="true"
		widgetVar="reprovar" closable="false" hideEffect="blind">
		<h:form>
			
			<p:commandButton value="Cancelar" onclick="reprovar.hide()"
				actionListener="#{tarefaControle.init}" global="false"
				style="height:32px;width:116px" />

			<p:commandButton id="confirmDelBtn" value="Confirmar"
				onsuccess="reprovar.hide()" ajax="false"
				actionListener="#{tarefaControle.reprovar(tarefaControle.entity)}"
				global="false" style="height:32px;width:116px" />

		</h:form>

	</p:confirmDialog>

	<p:confirmDialog message="Deseja realmente aprovar ?"
		header="CONFIRMAR" severity="alert" appendToBody="true"
		widgetVar="aprovar" closable="false" showEffect="slide"
		hideEffect="blind">
		<h:form>
			<p:commandButton value="Cancelar" onclick="aprovar.hide()"
				actionListener="#{tarefaControle.init}" global="false"
				style="height:32px;width:116px" />

			<p:commandButton id="confirmDelBtn" value="Confirmar"
				onsuccess="aprovar.hide()" ajax="false"
				actionListener="#{tarefaControle.aprovar(tarefaControle.entity)}"
				global="false" style="height:32px;width:116px" />
		</h:form>

	</p:confirmDialog>

</ui:component>