<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">



	<style type="text/css">
.ui-picklist-source, .ui-picklist-target {
	height: 400px;
	width: 400px;
}
</style>

	<h:form id="form" enctype="multipart/form-data">

		<p:panel id="panel" closable="false" footer="*Campos Obrigatórios"
			header="Cadastro de Publicação de Documento" style="width:99%">
			<p:growl id="msg" showDetail="true"/>
		
			<p:wizard flowListener="#{publicarDocumentoControlador.onFlowProcess}" >
				
				<p:tab title="Geral">
					<h:panelGrid style="width:30%" columns="4" cellspacing="4">
						<p:outputLabel value="Tipo de Documento: *" styleClass="ui-priority-primary"/>
						<p:outputLabel value="Unidade: *" styleClass="ui-priority-primary"/>
						<p:outputLabel value="Setor: *" styleClass="ui-priority-primary"/>
						<p:outputLabel value="Proprietário: *" styleClass="ui-priority-primary"/>
						
						<p:selectOneMenu
							value="#{publicarDocumentoControlador.variaveis.tipoDocumento}"
							converter="tipoDocumentoConverter">
							<f:selectItems
								value="#{publicarDocumentoControlador.variaveis.tipoDocumentos}"
								var="tipoDocumento" itemLabel="#{tipoDocumento.sigla}-#{tipoDocumento.nome}"
								itemValue="#{tipoDocumento}" />
						</p:selectOneMenu>
						
						<p:selectOneMenu required="true" id="unidade"
							value="#{publicarDocumentoControlador.variaveis.unidade}"
							converter="unidadeConverter">
							<f:selectItems
								value="#{publicarDocumentoControlador.variaveis.unidades}"
								var="unidade" itemLabel="#{unidade.nome}" itemValue="#{unidade}" />
						</p:selectOneMenu>
						
						<p:selectOneMenu
							value="#{publicarDocumentoControlador.variaveis.setor}"
							converter="setorConverter">
							<f:selectItems
								value="#{publicarDocumentoControlador.variaveis.setores}"
								var="setor" itemLabel="#{setor.nome}" itemValue="#{setor}" />
						</p:selectOneMenu>
						
						<p:selectOneMenu
							value="#{publicarDocumentoControlador.variaveis.proprietario}"
							converter="usuarioConverter">
							<f:selectItems
								value="#{publicarDocumentoControlador.variaveis.proprietarios}"
								var="proprietario"
								itemLabel="#{proprietario.firstName} #{proprietario.lastName}"
								itemValue="#{proprietario}" />
						</p:selectOneMenu>
						
					</h:panelGrid>
					
					<p />
					
					<h:panelGrid columns="1">
						<p:outputLabel value="Data de Vencimento: *" styleClass="ui-priority-primary" />
						<p:calendar id="dataVencimento" pattern="dd/MM/yyyy" mask="true"
							value="#{publicarDocumentoControlador.variaveis.dataVencimento}" />
					</h:panelGrid>
					
					<p />
					
					<h:panelGrid columns="1">
						<p:outputLabel value="Notificação de vencimento (dias antes): *" styleClass="ui-priority-primary"/>
						<p:inputText id="diasAntecedencia" style="width:20%"
							value="#{publicarDocumentoControlador.variaveis.notificarVencimento}" />
					</h:panelGrid>	
				</p:tab>
				
				<p:tab title="Aprovadores">
					<h:panelGroup style="width:99%">
						<p/>
						<p:pickList id="pickListAprovadores" value="#{publicarDocumentoControlador.aprovadores}" var="aprovador" 
							itemLabel="#{aprovador.firstName} #{aprovador.lastName}" itemValue="#{aprovador}" 
							converter="usuarioConverter"/>
					</h:panelGroup>
				</p:tab>
				
				<p:tab title="Concensão">
					<h:panelGroup style="width:99%">
						<p/>
						<p:outputLabel value="Enviar para Concensão? " styleClass="ui-priority-primary"/>
						
						<p:selectBooleanCheckbox id="enviarConcensao"  
							value="#{publicarDocumentoControlador.variaveis.enviarConcensao}" >
						
							<!-- TODO verificar atualizacao de componente -->
							<p:ajax update="@form"
								checked="#{publicarDocumentoControlador.variaveis.enviarConcensao}" />
						</p:selectBooleanCheckbox>	
						
						<p/>
							
						<p:pickList rendered="#{publicarDocumentoControlador.variaveis.enviarConcensao}" 
							id="pickListConcensoes" value="#{publicarDocumentoControlador.listaUsuarioConcensao}" var="usuarioConcensao" 
							itemLabel="#{usuarioConcensao.firstName} #{usuarioConcensao.lastName}" itemValue="#{usuarioConcensao}" 
							converter="usuarioConverter"/>
						
					</h:panelGroup>
				</p:tab>
				
				<p:tab title="Posto de Cópia">
					<h:panelGroup style="width:99%">
						
						<p/>
					
						<p:pickList id="pickListPostoCopia" value="#{publicarDocumentoControlador.listaPostosCopia}" var="postoCopia" 
							itemLabel="#{postoCopia.nome}" itemValue="#{postoCopia}" 
							converter="postoCopiaConverter"/>
					
					</h:panelGroup>
				</p:tab>	
				
				<p:tab title="Upload Documento">
					
					<h:panelGroup>
					
						<p/>
						<p:outputLabel value="Publicação Automática? " styleClass="ui-priority-primary"/>
						<p:selectBooleanCheckbox id="publicacaoAutomatica" 
							value="#{publicarDocumentoControlador.variaveis.publicacaoAutomatica}" />
						<p/>
						
						
						<p:fileUpload value="#{publicarDocumentoControlador.uploadedfile}" mode="simple"/>
						
						<p/>	
					</h:panelGroup>
					<div align="right">
					<p:commandButton id="buttonAvancar" value="Gerar Solicitação"
						ajax="true" update=":form, :sucessoDialog1"
						styleClass="ui-priority-primary" icon="ui-icon-circle-check"
						actionListener="#{publicarDocumentoControlador.salvarNovaSolicitacao}"/>
					</div>

				</p:tab>
			</p:wizard>
		</p:panel>
		
		
	</h:form>

	<p:dialog id="upload-dialog" header="Upload de Arquivo"
		widgetVar="upload"  appendToBody="true"
		width="50%">
		
		<h:form enctype="multipart/form-data">
			<p:fileUpload value="#{publicarDocumentoControlador.uploadedfile}" mode="simple"/>
			
			<p:commandButton value="Enviar Arquivo" actionListener="#{publicarDocumentoControlador.upload}"/>
		</h:form>
		
	</p:dialog>	
		
	<p:dialog id="sucessoDialog1" header="Sucesso!"
		widgetVar="sucessoDialog" modal="true" appendToBody="true"
		closable="false" width="30%">
		<div align="center">
			<h:form style="align: center;">
				<h:outputText value="Solicitação de treinamento criada com sucesso!" />
				<p />
				<h:outputText
					value="Protocolo da solicitação: #{publicarDocumentoControlador.protocolo}" />
				<p />
				<p:commandButton value="Ok" onclick="sucessoDialog.hide()"
					actionListener="#{publicarDocumentoControlador.inicioNovaSolicitacao}"
					global="false" style="height:32px;width:25%" />
			</h:form>
		</div>
	</p:dialog>

</ui:component>